#include <stdio.h>
#include <fcntl.h>
#include <sys/types.h>
#include <unistd.h>
#include <errno.h>
#include <stdlib.h>
#include <string.h>

void verify(int i) {
 if(i == -1) {
  printf("not correct source or destination folder");
  exit(1);
 }
}



int main (int argc, char ** argv) {

 const size_t BUFFER = 1024 * 1024;
 
 if(argc < 3) {
  printf("source and destination files are not provided\n");
  exit(1);
 }
 
 const char * source = argv[1];
 const char * destination = argv[2];
 int srcfd = open(source, O_RDONLY);
 verify(sourcefd);
 int destfd = open(destination, O_WRONLY | O_CREAT | O_TRUNC, S_IRUSR | S_IWUSR | S_IRGRP);
 verify(destinationfd);
 char * buf = (char*)malloc(BUFFER);
 size_t readCount = 0;
 while(1) {
  readCount = read(sourcefd, buf, BUFFER);
  verify(readCount);
  if(!readCount) {break;}
  count += readCount;
  size_t writeCount = write(destinationfd, buf, readCount);
  verify(writeCount);
 }

  int cl = close(sourcefd);
  verify(cl);
  cl = close(destinationfd);
  verify(cl);
  free(buf);
  printf("complete");
 return 0;
}
